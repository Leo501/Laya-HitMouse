var __extends = (this && this.__extends) || (function () {
    var extendStatics = Object.setPrototypeOf ||
        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
/**This class is automatically generated by LayaAirIDE, please do not make any modifications. */
var HammerMgr_1 = require("./manger/HammerMgr");
var GameMouseLayer_1 = require("./layer/GameMouseLayer");
/*
* 游戏初始化配置;
*/
var GameConfig = /** @class */ (function () {
    function GameConfig() {
    }
    GameConfig.init = function () {
        var reg = Laya.ClassUtils.regClass;
        reg("manger/HammerMgr.ts", HammerMgr_1.default);
        reg("layer/GameMouseLayer.ts", GameMouseLayer_1.default);
    };
    GameConfig.width = 1136;
    GameConfig.height = 640;
    GameConfig.scaleMode = "fixedwidth";
    GameConfig.screenMode = "horizontal";
    GameConfig.alignV = "middle";
    GameConfig.alignH = "center";
    GameConfig.startScene = "Scene/GameMain.scene";
    GameConfig.sceneRoot = "";
    GameConfig.debug = false;
    GameConfig.stat = false;
    GameConfig.physicsDebug = false;
    GameConfig.exportSceneToJson = true;
    return GameConfig;
}());
exports.default = GameConfig;
GameConfig.init();

},{"./layer/GameMouseLayer":3,"./manger/HammerMgr":4}],2:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var GameConfig_1 = require("./GameConfig");
var Main = /** @class */ (function () {
    function Main() {
        //根据IDE设置初始化引擎		
        if (window["Laya3D"])
            Laya3D.init(GameConfig_1.default.width, GameConfig_1.default.height);
        else
            Laya.init(GameConfig_1.default.width, GameConfig_1.default.height, Laya["WebGL"]);
        Laya["Physics"] && Laya["Physics"].enable();
        Laya["DebugPanel"] && Laya["DebugPanel"].enable();
        Laya.stage.scaleMode = GameConfig_1.default.scaleMode;
        Laya.stage.screenMode = GameConfig_1.default.screenMode;
        //兼容微信不支持加载scene后缀场景
        Laya.URL.exportSceneToJson = GameConfig_1.default.exportSceneToJson;
        //打开调试面板（通过IDE设置调试模式，或者url地址增加debug=true参数，均可打开调试面板）
        if (GameConfig_1.default.debug || Laya.Utils.getQueryString("debug") == "true")
            Laya.enableDebugPanel();
        if (GameConfig_1.default.physicsDebug && Laya["PhysicsDebugDraw"])
            Laya["PhysicsDebugDraw"].enable();
        if (GameConfig_1.default.stat)
            Laya.Stat.show();
        Laya.alertGlobalError = true;
        //激活资源版本控制，version.json由IDE发布功能自动生成，如果没有也不影响后续流程
        Laya.ResourceVersion.enable("version.json", Laya.Handler.create(this, this.onVersionLoaded), Laya.ResourceVersion.FILENAME_VERSION);
    }
    Main.prototype.onVersionLoaded = function () {
        //激活大小图映射，加载小图的时候，如果发现小图在大图合集里面，则优先加载大图合集，而不是小图
        Laya.AtlasInfoManager.enable("fileconfig.json", Laya.Handler.create(this, this.onConfigLoaded));
    };
    Main.prototype.onConfigLoaded = function () {
        //加载IDE指定的场景
        GameConfig_1.default.startScene && Laya.Scene.open(GameConfig_1.default.startScene);
    };
    return Main;
}());
//激活启动类
new Main();

},{"./GameConfig":1}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var GameModel_1 = require("../module/GameModel");
var ListenerManger_1 = require("../manger/ListenerManger");
var GameLayer = /** @class */ (function (_super) {
    __extends(GameLayer, _super);
    function GameLayer() {
        var _this = _super.call(this) || this;
        _this.mouseArr = [];
        _this.skis = ['ui/mouse_normal_1.png', 'ui/mouse_normal_2.png'];
        _this.hitSkis = ['ui/mouse_hit_1.png', 'ui/mouse_hit_2.png'];
        return _this;
    }
    GameLayer.prototype.onEnable = function () {
        ListenerManger_1.ListenerMgr.Instance().on('onHammerHit', this, this.onCheckHit);
    };
    GameLayer.prototype.onStart = function () {
        this.mouseBirthAI();
    };
    GameLayer.prototype.mouseBirthAI = function () {
        var id = (Math.random() * 9 + 1) | 0;
        while (id == GameModel_1.default.Instacne().curHoleIdx) {
            id = (Math.random() * 9 + 1) | 0;
        }
        var type = ((Math.random() * 4) | 0);
        type = type == 0 ? 1 : 0;
        if (!this.mouseArr[id]) {
            this.mouseArr[id] = this.mousCreateById(id, type);
        }
        var mouse = this.mouseArr[id];
        mouse.skin = this.skis[type];
        this.mouseUpAnim(mouse);
        Laya.timer.once(1500, this, this.mouseDownAnim, [mouse]);
        GameModel_1.default.Instacne().curMouseType = type;
        GameModel_1.default.Instacne().curHoleIdx = id;
    };
    GameLayer.prototype.mousCreateById = function (id, type) {
        var mouseItem = this.owner.getChildByName('mouseItem_' + id);
        var bg = mouseItem.getChildByName('bg');
        var mouse = new Laya.Image(this.skis[type]);
        mouse.alpha = 0;
        bg.addChild(mouse);
        return mouse;
    };
    GameLayer.prototype.mouseUpAnim = function (celler) {
        celler.visible = true;
        Laya.Tween.to(celler, { alpha: 1 }, 100);
        Laya.Tween.to(celler, { y: -23 }, 200, Laya.Ease.linearIn, null, 100);
    };
    GameLayer.prototype.stopMouseDownTimeout = function () {
        Laya.timer.clear(this, this.mouseDownAnim);
    };
    GameLayer.prototype.mouseDownAnim = function (celler) {
        var _this = this;
        Laya.Tween.to(celler, { y: 0 }, 200);
        Laya.Tween.to(celler, { alpha: 0 }, 100, Laya.Ease.linearIn, Laya.Handler.create(this, function () {
            celler.visible = false;
            _this.mouseBirthAI();
        }), 200);
    };
    GameLayer.prototype.checkHit = function (bounds) {
        for (var i = 1; i <= 10; i++) {
            var mouse = this.mouseArr[i];
            if (!mouse)
                continue;
            var targetBounds = mouse.getBounds();
            var globalPos = mouse.localToGlobal(new Laya.Point(0, 0));
            targetBounds.x = globalPos.x;
            targetBounds.y = globalPos.y;
            var isHit = targetBounds.intersection(bounds);
            if (isHit)
                return i;
        }
        return -1;
    };
    GameLayer.prototype.hitMouseAnim = function (celler) {
        celler.y = 0;
        celler.skin = this.hitSkis[GameModel_1.default.Instacne().curMouseType];
        // Laya.Tween.to(celler, { alpha: 0 }, 100, Laya.Ease.linearIn, Laya.Handler.create(this, () => {
        //     celler.y = 0;
        //     celler.visible = false;
        // }));
    };
    GameLayer.prototype.onCheckHit = function (hammer) {
        var idx = this.checkHit(hammer.getBounds());
        console.log('hit mouse No is ', idx);
        var mouse = this.mouseArr[idx];
        mouse && this.hitMouseAnim(mouse);
    };
    GameLayer.prototype.onDisable = function () {
        ListenerManger_1.ListenerMgr.Instance().offAllCaller(this);
    };
    return GameLayer;
}(Laya.Script));
exports.default = GameLayer;

},{"../manger/ListenerManger":5,"../module/GameModel":6}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var ListenerManger_1 = require("../manger/ListenerManger");
var HannerMgr = /** @class */ (function (_super) {
    __extends(HannerMgr, _super);
    function HannerMgr() {
        return _super.call(this) || this;
    }
    HannerMgr.prototype.onEnable = function () {
        ListenerManger_1.ListenerMgr.Instance().on('onHammerHit', this, this.onHammerPlay);
        ListenerManger_1.ListenerMgr.Instance().on('onHammerMove', this, this.onHammerMove);
    };
    HannerMgr.prototype.onStart = function () {
        var effect = Laya.Pool.getItemByCreateFun("HammnerAnim", this.createAnim, this);
        this.owner.addChild(effect);
        this.hammer = effect;
        this.hammer.play(0, false);
        this.hammer.pos(-100, -100);
    };
    HannerMgr.prototype.onHammerPlay = function () {
        this.hammer && this.hammer.play(0, false);
    };
    HannerMgr.prototype.onHammerMove = function (pos) {
        this.hammer && this.hammer.pos(pos.x, pos.y);
    };
    HannerMgr.prototype.createAnim = function () {
        var resPath = "Anims/Hammer.ani";
        var ani = new Laya.Animation();
        ani.loadAnimation(resPath);
        return ani;
    };
    HannerMgr.prototype.onMouseDown = function (data) {
        this.onHammerPlay();
        ListenerManger_1.ListenerMgr.Instance().event('onHammerHit', this.hammer);
    };
    HannerMgr.prototype.onMouseMove = function (data) {
        this.onHammerMove(new Laya.Point(data.stageX, data.stageY));
    };
    HannerMgr.prototype.onDisable = function () {
        ListenerManger_1.ListenerMgr.Instance().offAllCaller(this);
    };
    return HannerMgr;
}(Laya.Script));
exports.default = HannerMgr;

},{"../manger/ListenerManger":5}],5:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var ListenerMgr = /** @class */ (function (_super) {
    __extends(ListenerMgr, _super);
    function ListenerMgr() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    ListenerMgr.Instance = function () {
        return this.instance;
    };
    ListenerMgr.instance = new Laya.EventDispatcher();
    return ListenerMgr;
}(Laya.EventDispatcher));
exports.ListenerMgr = ListenerMgr;

},{}],6:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var GameModel = /** @class */ (function () {
    function GameModel() {
    }
    GameModel.Instacne = function () {
        if (!GameModel.instance) {
            GameModel.instance = new GameModel();
        }
        return GameModel.instance;
    };
    Object.defineProperty(GameModel.prototype, "curMouseType", {
        get: function () {
            return this._curMouseType;
        },
        set: function (type) {
            this._curMouseType = type;
        },
        enumerable: true,
        configurable: true
    });
    Object.defineProperty(GameModel.prototype, "curHoleIdx", {
        get: function () {
            return this._curHoleIdx;
        },
        set: function (idx) {
            this._curHoleIdx = idx;
        },
        enumerable: true,
        configurable: true
    });
    GameModel.prototype.getHearCount = function () {
        return this._hearCount;
    };
    GameModel.prototype.hearCountMinus = function () {
        this._hearCount--;
        if (this._hearCount < 0) {
            this._hearCount = 0;
        }
    };
    Object.defineProperty(GameModel.prototype, "gameScore", {
        get: function () {
            return this._gameScore;
        },
        set: function (num) {
            this._gameScore = num;
        },
        enumerable: true,
        configurable: true
    });
    return GameModel;
}());
exports.default = GameModel;

},{}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL0FwcGxpY2F0aW9ucy9MYXlhQWlySURFX2JldGEuYXBwL0NvbnRlbnRzL1Jlc291cmNlcy9hcHAvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsInNyYy9HYW1lQ29uZmlnLnRzIiwic3JjL01haW4udHMiLCJzcmMvbGF5ZXIvR2FtZU1vdXNlTGF5ZXIudHMiLCJzcmMvbWFuZ2VyL0hhbW1lck1nci50cyIsInNyYy9tYW5nZXIvTGlzdGVuZXJNYW5nZXIudHMiLCJzcmMvbW9kdWxlL0dhbWVNb2RlbC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7QUNWQSxnR0FBZ0c7QUFDaEcsZ0RBQTBDO0FBQzFDLHlEQUFtRDtBQUNuRDs7RUFFRTtBQUNGO0lBYUk7SUFBYyxDQUFDO0lBQ1IsZUFBSSxHQUFYO1FBQ0ksSUFBSSxHQUFHLEdBQWEsSUFBSSxDQUFDLFVBQVUsQ0FBQyxRQUFRLENBQUM7UUFDN0MsR0FBRyxDQUFDLHFCQUFxQixFQUFDLG1CQUFTLENBQUMsQ0FBQztRQUNyQyxHQUFHLENBQUMseUJBQXlCLEVBQUMsd0JBQWMsQ0FBQyxDQUFDO0lBQ2xELENBQUM7SUFqQk0sZ0JBQUssR0FBUSxJQUFJLENBQUM7SUFDbEIsaUJBQU0sR0FBUSxHQUFHLENBQUM7SUFDbEIsb0JBQVMsR0FBUSxZQUFZLENBQUM7SUFDOUIscUJBQVUsR0FBUSxZQUFZLENBQUM7SUFDL0IsaUJBQU0sR0FBUSxRQUFRLENBQUM7SUFDdkIsaUJBQU0sR0FBUSxRQUFRLENBQUM7SUFDdkIscUJBQVUsR0FBSyxzQkFBc0IsQ0FBQztJQUN0QyxvQkFBUyxHQUFRLEVBQUUsQ0FBQztJQUNwQixnQkFBSyxHQUFTLEtBQUssQ0FBQztJQUNwQixlQUFJLEdBQVMsS0FBSyxDQUFDO0lBQ25CLHVCQUFZLEdBQVMsS0FBSyxDQUFDO0lBQzNC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QUFzQixHQUFHO1lBQ3JCLElBQUksQ0FBQyxXQUFXLEdBQUcsR0FBRyxDQUFDO1FBQzNCLENBQUM7OztPQUpBO0lBUU0sZ0NBQVksR0FBbkI7UUFDSSxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7SUFDM0IsQ0FBQztJQUVNLGtDQUFjLEdBQXJCO1FBQ0ksSUFBSSxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ2xCLElBQUksSUFBSSxDQUFDLFVBQVUsR0FBRyxDQUFDLEVBQUU7WUFDckIsSUFBSSxDQUFDLFVBQVUsR0FBRyxDQUFDLENBQUM7U0FDdkI7SUFDTCxDQUFDO0lBSUQsc0JBQVcsZ0NBQVM7YUFBcEI7WUFDSSxPQUFPLElBQUksQ0FBQyxVQUFVLENBQUM7UUFDM0IsQ0FBQzthQUVELFVBQXFCLEdBQVc7WUFDNUIsSUFBSSxDQUFDLFVBQVUsR0FBRyxHQUFHLENBQUM7UUFDMUIsQ0FBQzs7O09BSkE7SUFPTCxnQkFBQztBQUFELENBM0RBLEFBMkRDLElBQUEiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbInZhciBfX2V4dGVuZHMgPSAodGhpcyAmJiB0aGlzLl9fZXh0ZW5kcykgfHwgKGZ1bmN0aW9uICgpIHtcclxuICAgIHZhciBleHRlbmRTdGF0aWNzID0gT2JqZWN0LnNldFByb3RvdHlwZU9mIHx8XHJcbiAgICAgICAgKHsgX19wcm90b19fOiBbXSB9IGluc3RhbmNlb2YgQXJyYXkgJiYgZnVuY3Rpb24gKGQsIGIpIHsgZC5fX3Byb3RvX18gPSBiOyB9KSB8fFxyXG4gICAgICAgIGZ1bmN0aW9uIChkLCBiKSB7IGZvciAodmFyIHAgaW4gYikgaWYgKGIuaGFzT3duUHJvcGVydHkocCkpIGRbcF0gPSBiW3BdOyB9O1xyXG4gICAgcmV0dXJuIGZ1bmN0aW9uIChkLCBiKSB7XHJcbiAgICAgICAgZXh0ZW5kU3RhdGljcyhkLCBiKTtcclxuICAgICAgICBmdW5jdGlvbiBfXygpIHsgdGhpcy5jb25zdHJ1Y3RvciA9IGQ7IH1cclxuICAgICAgICBkLnByb3RvdHlwZSA9IGIgPT09IG51bGwgPyBPYmplY3QuY3JlYXRlKGIpIDogKF9fLnByb3RvdHlwZSA9IGIucHJvdG90eXBlLCBuZXcgX18oKSk7XHJcbiAgICB9O1xyXG59KSgpO1xyXG4oZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiLyoqVGhpcyBjbGFzcyBpcyBhdXRvbWF0aWNhbGx5IGdlbmVyYXRlZCBieSBMYXlhQWlySURFLCBwbGVhc2UgZG8gbm90IG1ha2UgYW55IG1vZGlmaWNhdGlvbnMuICovXHJcbmltcG9ydCBIYW1tZXJNZ3IgZnJvbSBcIi4vbWFuZ2VyL0hhbW1lck1nclwiXG5pbXBvcnQgR2FtZU1vdXNlTGF5ZXIgZnJvbSBcIi4vbGF5ZXIvR2FtZU1vdXNlTGF5ZXJcIlxyXG4vKlxyXG4qIOa4uOaIj+WIneWni+WMlumFjee9rjtcclxuKi9cclxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgR2FtZUNvbmZpZ3tcclxuICAgIHN0YXRpYyB3aWR0aDpudW1iZXI9MTEzNjtcclxuICAgIHN0YXRpYyBoZWlnaHQ6bnVtYmVyPTY0MDtcclxuICAgIHN0YXRpYyBzY2FsZU1vZGU6c3RyaW5nPVwiZml4ZWR3aWR0aFwiO1xyXG4gICAgc3RhdGljIHNjcmVlbk1vZGU6c3RyaW5nPVwiaG9yaXpvbnRhbFwiO1xyXG4gICAgc3RhdGljIGFsaWduVjpzdHJpbmc9XCJtaWRkbGVcIjtcclxuICAgIHN0YXRpYyBhbGlnbkg6c3RyaW5nPVwiY2VudGVyXCI7XHJcbiAgICBzdGF0aWMgc3RhcnRTY2VuZTphbnk9XCJTY2VuZS9HYW1lTWFpbi5zY2VuZVwiO1xyXG4gICAgc3RhdGljIHNjZW5lUm9vdDpzdHJpbmc9XCJcIjtcclxuICAgIHN0YXRpYyBkZWJ1Zzpib29sZWFuPWZhbHNlO1xyXG4gICAgc3RhdGljIHN0YXQ6Ym9vbGVhbj1mYWxzZTtcclxuICAgIHN0YXRpYyBwaHlzaWNzRGVidWc6Ym9vbGVhbj1mYWxzZTtcclxuICAgIHN0YXRpYyBleHBvcnRTY2VuZVRvSnNvbjpib29sZWFuPXRydWU7XHJcbiAgICBjb25zdHJ1Y3Rvcigpe31cclxuICAgIHN0YXRpYyBpbml0KCl7XHJcbiAgICAgICAgdmFyIHJlZzogRnVuY3Rpb24gPSBMYXlhLkNsYXNzVXRpbHMucmVnQ2xhc3M7XHJcbiAgICAgICAgcmVnKFwibWFuZ2VyL0hhbW1lck1nci50c1wiLEhhbW1lck1ncik7XG4gICAgICAgIHJlZyhcImxheWVyL0dhbWVNb3VzZUxheWVyLnRzXCIsR2FtZU1vdXNlTGF5ZXIpO1xyXG4gICAgfVxyXG59XHJcbkdhbWVDb25maWcuaW5pdCgpOyIsImltcG9ydCBHYW1lQ29uZmlnIGZyb20gXCIuL0dhbWVDb25maWdcIjtcclxuY2xhc3MgTWFpbiB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHQvL+agueaNrklEReiuvue9ruWIneWni+WMluW8leaTjlx0XHRcclxuXHRcdGlmICh3aW5kb3dbXCJMYXlhM0RcIl0pIExheWEzRC5pbml0KEdhbWVDb25maWcud2lkdGgsIEdhbWVDb25maWcuaGVpZ2h0KTtcclxuXHRcdGVsc2UgTGF5YS5pbml0KEdhbWVDb25maWcud2lkdGgsIEdhbWVDb25maWcuaGVpZ2h0LCBMYXlhW1wiV2ViR0xcIl0pO1xyXG5cdFx0TGF5YVtcIlBoeXNpY3NcIl0gJiYgTGF5YVtcIlBoeXNpY3NcIl0uZW5hYmxlKCk7XHJcblx0XHRMYXlhW1wiRGVidWdQYW5lbFwiXSAmJiBMYXlhW1wiRGVidWdQYW5lbFwiXS5lbmFibGUoKTtcclxuXHRcdExheWEuc3RhZ2Uuc2NhbGVNb2RlID0gR2FtZUNvbmZpZy5zY2FsZU1vZGU7XHJcblx0XHRMYXlhLnN0YWdlLnNjcmVlbk1vZGUgPSBHYW1lQ29uZmlnLnNjcmVlbk1vZGU7XHJcblx0XHQvL+WFvOWuueW+ruS/oeS4jeaUr+aMgeWKoOi9vXNjZW5l5ZCO57yA5Zy65pmvXHJcblx0XHRMYXlhLlVSTC5leHBvcnRTY2VuZVRvSnNvbiA9IEdhbWVDb25maWcuZXhwb3J0U2NlbmVUb0pzb247XHJcblxyXG5cdFx0Ly/miZPlvIDosIPor5XpnaLmnb/vvIjpgJrov4dJREXorr7nva7osIPor5XmqKHlvI/vvIzmiJbogIV1cmzlnLDlnYDlop7liqBkZWJ1Zz10cnVl5Y+C5pWw77yM5Z2H5Y+v5omT5byA6LCD6K+V6Z2i5p2/77yJXHJcblx0XHRpZiAoR2FtZUNvbmZpZy5kZWJ1ZyB8fCBMYXlhLlV0aWxzLmdldFF1ZXJ5U3RyaW5nKFwiZGVidWdcIikgPT0gXCJ0cnVlXCIpIExheWEuZW5hYmxlRGVidWdQYW5lbCgpO1xyXG5cdFx0aWYgKEdhbWVDb25maWcucGh5c2ljc0RlYnVnICYmIExheWFbXCJQaHlzaWNzRGVidWdEcmF3XCJdKSBMYXlhW1wiUGh5c2ljc0RlYnVnRHJhd1wiXS5lbmFibGUoKTtcclxuXHRcdGlmIChHYW1lQ29uZmlnLnN0YXQpIExheWEuU3RhdC5zaG93KCk7XHJcblx0XHRMYXlhLmFsZXJ0R2xvYmFsRXJyb3IgPSB0cnVlO1xyXG5cclxuXHRcdC8v5r+A5rS76LWE5rqQ54mI5pys5o6n5Yi277yMdmVyc2lvbi5qc29u55SxSURF5Y+R5biD5Yqf6IO96Ieq5Yqo55Sf5oiQ77yM5aaC5p6c5rKh5pyJ5Lmf5LiN5b2x5ZON5ZCO57ut5rWB56iLXHJcblx0XHRMYXlhLlJlc291cmNlVmVyc2lvbi5lbmFibGUoXCJ2ZXJzaW9uLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uVmVyc2lvbkxvYWRlZCksIExheWEuUmVzb3VyY2VWZXJzaW9uLkZJTEVOQU1FX1ZFUlNJT04pO1xyXG5cdH1cclxuXHJcblx0b25WZXJzaW9uTG9hZGVkKCk6IHZvaWQge1xyXG5cdFx0Ly/mv4DmtLvlpKflsI/lm77mmKDlsITvvIzliqDovb3lsI/lm77nmoTml7blgJnvvIzlpoLmnpzlj5HnjrDlsI/lm77lnKjlpKflm77lkIjpm4bph4zpnaLvvIzliJnkvJjlhYjliqDovb3lpKflm77lkIjpm4bvvIzogIzkuI3mmK/lsI/lm75cclxuXHRcdExheWEuQXRsYXNJbmZvTWFuYWdlci5lbmFibGUoXCJmaWxlY29uZmlnLmpzb25cIiwgTGF5YS5IYW5kbGVyLmNyZWF0ZSh0aGlzLCB0aGlzLm9uQ29uZmlnTG9hZGVkKSk7XHJcblx0fVxyXG5cclxuXHRvbkNvbmZpZ0xvYWRlZCgpOiB2b2lkIHtcclxuXHRcdC8v5Yqg6L29SURF5oyH5a6a55qE5Zy65pmvXHJcblx0XHRHYW1lQ29uZmlnLnN0YXJ0U2NlbmUgJiYgTGF5YS5TY2VuZS5vcGVuKEdhbWVDb25maWcuc3RhcnRTY2VuZSk7XHJcblx0fVxyXG59XHJcbi8v5r+A5rS75ZCv5Yqo57G7XHJcbm5ldyBNYWluKCk7XHJcbiIsImltcG9ydCBHYW1lTW9kZWwgZnJvbSBcIi4uL21vZHVsZS9HYW1lTW9kZWxcIjtcclxuaW1wb3J0IHsgTGlzdGVuZXJNZ3IgfSBmcm9tIFwiLi4vbWFuZ2VyL0xpc3RlbmVyTWFuZ2VyXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lTGF5ZXIgZXh0ZW5kcyBMYXlhLlNjcmlwdCB7XHJcblxyXG4gICAgcHJpdmF0ZSBtb3VzZUFyciA9IFtdO1xyXG5cclxuICAgIHByaXZhdGUgc2tpcyA9IFsndWkvbW91c2Vfbm9ybWFsXzEucG5nJywgJ3VpL21vdXNlX25vcm1hbF8yLnBuZyddO1xyXG5cclxuICAgIHByaXZhdGUgaGl0U2tpcyA9IFsndWkvbW91c2VfaGl0XzEucG5nJywgJ3VpL21vdXNlX2hpdF8yLnBuZyddO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkgeyBzdXBlcigpOyB9XHJcblxyXG4gICAgb25FbmFibGUoKTogdm9pZCB7XHJcbiAgICAgICAgTGlzdGVuZXJNZ3IuSW5zdGFuY2UoKS5vbignb25IYW1tZXJIaXQnLCB0aGlzLCB0aGlzLm9uQ2hlY2tIaXQpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU3RhcnQoKSB7XHJcbiAgICAgICAgdGhpcy5tb3VzZUJpcnRoQUkoKTtcclxuICAgIH1cclxuXHJcbiAgICBtb3VzZUJpcnRoQUkoKSB7XHJcbiAgICAgICAgbGV0IGlkID0gKE1hdGgucmFuZG9tKCkgKiA5ICsgMSkgfCAwO1xyXG4gICAgICAgIHdoaWxlIChpZCA9PSBHYW1lTW9kZWwuSW5zdGFjbmUoKS5jdXJIb2xlSWR4KSB7XHJcbiAgICAgICAgICAgIGlkID0gKE1hdGgucmFuZG9tKCkgKiA5ICsgMSkgfCAwO1xyXG4gICAgICAgIH1cclxuICAgICAgICBsZXQgdHlwZSA9ICgoTWF0aC5yYW5kb20oKSAqIDQpIHwgMCk7XHJcbiAgICAgICAgdHlwZSA9IHR5cGUgPT0gMCA/IDEgOiAwO1xyXG5cclxuICAgICAgICBpZiAoIXRoaXMubW91c2VBcnJbaWRdKSB7XHJcbiAgICAgICAgICAgIHRoaXMubW91c2VBcnJbaWRdID0gdGhpcy5tb3VzQ3JlYXRlQnlJZChpZCwgdHlwZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGxldCBtb3VzZSA9IHRoaXMubW91c2VBcnJbaWRdIGFzIExheWEuSW1hZ2U7XHJcbiAgICAgICAgbW91c2Uuc2tpbiA9IHRoaXMuc2tpc1t0eXBlXTtcclxuXHJcbiAgICAgICAgdGhpcy5tb3VzZVVwQW5pbShtb3VzZSk7XHJcbiAgICAgICAgTGF5YS50aW1lci5vbmNlKDE1MDAsIHRoaXMsIHRoaXMubW91c2VEb3duQW5pbSwgW21vdXNlXSk7XHJcblxyXG4gICAgICAgIEdhbWVNb2RlbC5JbnN0YWNuZSgpLmN1ck1vdXNlVHlwZSA9IHR5cGU7XHJcbiAgICAgICAgR2FtZU1vZGVsLkluc3RhY25lKCkuY3VySG9sZUlkeCA9IGlkO1xyXG4gICAgfVxyXG5cclxuICAgIG1vdXNDcmVhdGVCeUlkKGlkLCB0eXBlKSB7XHJcbiAgICAgICAgbGV0IG1vdXNlSXRlbSA9IHRoaXMub3duZXIuZ2V0Q2hpbGRCeU5hbWUoJ21vdXNlSXRlbV8nICsgaWQpO1xyXG4gICAgICAgIGxldCBiZyA9IG1vdXNlSXRlbS5nZXRDaGlsZEJ5TmFtZSgnYmcnKTtcclxuXHJcbiAgICAgICAgbGV0IG1vdXNlID0gbmV3IExheWEuSW1hZ2UodGhpcy5za2lzW3R5cGVdKTtcclxuICAgICAgICBtb3VzZS5hbHBoYSA9IDA7XHJcbiAgICAgICAgYmcuYWRkQ2hpbGQobW91c2UpO1xyXG4gICAgICAgIHJldHVybiBtb3VzZTtcclxuICAgIH1cclxuXHJcbiAgICBtb3VzZVVwQW5pbShjZWxsZXI6IExheWEuSW1hZ2UpIHtcclxuICAgICAgICBjZWxsZXIudmlzaWJsZSA9IHRydWU7XHJcbiAgICAgICAgTGF5YS5Ud2Vlbi50byhjZWxsZXIsIHsgYWxwaGE6IDEgfSwgMTAwKTtcclxuICAgICAgICBMYXlhLlR3ZWVuLnRvKGNlbGxlciwgeyB5OiAtMjMgfSwgMjAwLCBMYXlhLkVhc2UubGluZWFySW4sIG51bGwsIDEwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgc3RvcE1vdXNlRG93blRpbWVvdXQoKSB7XHJcbiAgICAgICAgTGF5YS50aW1lci5jbGVhcih0aGlzLCB0aGlzLm1vdXNlRG93bkFuaW0pXHJcbiAgICB9XHJcblxyXG4gICAgbW91c2VEb3duQW5pbShjZWxsZXI6IExheWEuSW1hZ2UpIHtcclxuICAgICAgICBMYXlhLlR3ZWVuLnRvKGNlbGxlciwgeyB5OiAwIH0sIDIwMCk7XHJcbiAgICAgICAgTGF5YS5Ud2Vlbi50byhjZWxsZXIsIHsgYWxwaGE6IDAgfSwgMTAwLCBMYXlhLkVhc2UubGluZWFySW4sIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgKCkgPT4ge1xyXG4gICAgICAgICAgICBjZWxsZXIudmlzaWJsZSA9IGZhbHNlO1xyXG4gICAgICAgICAgICB0aGlzLm1vdXNlQmlydGhBSSgpO1xyXG4gICAgICAgIH0pLCAyMDApO1xyXG4gICAgfVxyXG5cclxuICAgIGNoZWNrSGl0KGJvdW5kczogTGF5YS5SZWN0YW5nbGUpIHtcclxuICAgICAgICBmb3IgKGxldCBpID0gMTsgaSA8PSAxMDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGxldCBtb3VzZSA9IHRoaXMubW91c2VBcnJbaV0gYXMgTGF5YS5JbWFnZTtcclxuICAgICAgICAgICAgaWYgKCFtb3VzZSkgY29udGludWU7XHJcbiAgICAgICAgICAgIGxldCB0YXJnZXRCb3VuZHMgPSBtb3VzZS5nZXRCb3VuZHMoKTtcclxuICAgICAgICAgICAgbGV0IGdsb2JhbFBvcyA9IG1vdXNlLmxvY2FsVG9HbG9iYWwobmV3IExheWEuUG9pbnQoMCwgMCkpO1xyXG4gICAgICAgICAgICB0YXJnZXRCb3VuZHMueCA9IGdsb2JhbFBvcy54O1xyXG4gICAgICAgICAgICB0YXJnZXRCb3VuZHMueSA9IGdsb2JhbFBvcy55O1xyXG4gICAgICAgICAgICBsZXQgaXNIaXQgPSB0YXJnZXRCb3VuZHMuaW50ZXJzZWN0aW9uKGJvdW5kcyk7XHJcbiAgICAgICAgICAgIGlmIChpc0hpdCkgcmV0dXJuIGk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHJldHVybiAtMTtcclxuICAgIH1cclxuXHJcbiAgICBoaXRNb3VzZUFuaW0oY2VsbGVyOiBMYXlhLkltYWdlKSB7XHJcbiAgICAgICAgY2VsbGVyLnkgPSAwO1xyXG4gICAgICAgIGNlbGxlci5za2luID0gdGhpcy5oaXRTa2lzW0dhbWVNb2RlbC5JbnN0YWNuZSgpLmN1ck1vdXNlVHlwZV07XHJcbiAgICAgICAgLy8gTGF5YS5Ud2Vlbi50byhjZWxsZXIsIHsgYWxwaGE6IDAgfSwgMTAwLCBMYXlhLkVhc2UubGluZWFySW4sIExheWEuSGFuZGxlci5jcmVhdGUodGhpcywgKCkgPT4ge1xyXG4gICAgICAgIC8vICAgICBjZWxsZXIueSA9IDA7XHJcbiAgICAgICAgLy8gICAgIGNlbGxlci52aXNpYmxlID0gZmFsc2U7XHJcbiAgICAgICAgLy8gfSkpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uQ2hlY2tIaXQoaGFtbWVyOiBMYXlhLlNwcml0ZSkge1xyXG4gICAgICAgIGxldCBpZHggPSB0aGlzLmNoZWNrSGl0KGhhbW1lci5nZXRCb3VuZHMoKSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2hpdCBtb3VzZSBObyBpcyAnLCBpZHgpO1xyXG4gICAgICAgIGxldCBtb3VzZSA9IHRoaXMubW91c2VBcnJbaWR4XTtcclxuICAgICAgICBtb3VzZSAmJiB0aGlzLmhpdE1vdXNlQW5pbShtb3VzZSk7XHJcbiAgICB9XHJcblxyXG4gICAgb25EaXNhYmxlKCk6IHZvaWQge1xyXG4gICAgICAgIExpc3RlbmVyTWdyLkluc3RhbmNlKCkub2ZmQWxsQ2FsbGVyKHRoaXMpO1xyXG4gICAgfVxyXG59IiwiaW1wb3J0IHsgTGlzdGVuZXJNZ3IgfSBmcm9tIFwiLi4vbWFuZ2VyL0xpc3RlbmVyTWFuZ2VyXCI7XHJcblxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBIYW5uZXJNZ3IgZXh0ZW5kcyBMYXlhLlNjcmlwdCB7XHJcblxyXG4gICAgcHJpdmF0ZSBoYW1tZXI6IExheWEuQW5pbWF0aW9uO1xyXG5cclxuICAgIGNvbnN0cnVjdG9yKCkgeyBzdXBlcigpOyB9XHJcblxyXG4gICAgb25FbmFibGUoKTogdm9pZCB7XHJcbiAgICAgICAgTGlzdGVuZXJNZ3IuSW5zdGFuY2UoKS5vbignb25IYW1tZXJIaXQnLCB0aGlzLCB0aGlzLm9uSGFtbWVyUGxheSk7XHJcbiAgICAgICAgTGlzdGVuZXJNZ3IuSW5zdGFuY2UoKS5vbignb25IYW1tZXJNb3ZlJywgdGhpcywgdGhpcy5vbkhhbW1lck1vdmUpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uU3RhcnQoKSB7XHJcbiAgICAgICAgbGV0IGVmZmVjdCA9IExheWEuUG9vbC5nZXRJdGVtQnlDcmVhdGVGdW4oXCJIYW1tbmVyQW5pbVwiLCB0aGlzLmNyZWF0ZUFuaW0sIHRoaXMpO1xyXG4gICAgICAgIHRoaXMub3duZXIuYWRkQ2hpbGQoZWZmZWN0KTtcclxuICAgICAgICB0aGlzLmhhbW1lciA9IGVmZmVjdDtcclxuICAgICAgICB0aGlzLmhhbW1lci5wbGF5KDAsIGZhbHNlKTtcclxuICAgICAgICB0aGlzLmhhbW1lci5wb3MoLTEwMCwgLTEwMCk7XHJcbiAgICB9XHJcblxyXG4gICAgb25IYW1tZXJQbGF5KCkge1xyXG4gICAgICAgIHRoaXMuaGFtbWVyICYmIHRoaXMuaGFtbWVyLnBsYXkoMCwgZmFsc2UpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uSGFtbWVyTW92ZShwb3M6IExheWEuUG9pbnQpIHtcclxuICAgICAgICB0aGlzLmhhbW1lciAmJiB0aGlzLmhhbW1lci5wb3MocG9zLngsIHBvcy55KTtcclxuICAgIH1cclxuXHJcbiAgICBjcmVhdGVBbmltKCk6IExheWEuQW5pbWF0aW9uIHtcclxuICAgICAgICBsZXQgcmVzUGF0aCA9IFwiQW5pbXMvSGFtbWVyLmFuaVwiO1xyXG4gICAgICAgIGxldCBhbmk6IExheWEuQW5pbWF0aW9uID0gbmV3IExheWEuQW5pbWF0aW9uKCk7XHJcbiAgICAgICAgYW5pLmxvYWRBbmltYXRpb24ocmVzUGF0aCk7XHJcbiAgICAgICAgcmV0dXJuIGFuaTtcclxuICAgIH1cclxuXHJcbiAgICBvbk1vdXNlRG93bihkYXRhOiBMYXlhLkV2ZW50KSB7XHJcbiAgICAgICAgdGhpcy5vbkhhbW1lclBsYXkoKTtcclxuICAgICAgICBMaXN0ZW5lck1nci5JbnN0YW5jZSgpLmV2ZW50KCdvbkhhbW1lckhpdCcsdGhpcy5oYW1tZXIpXHJcbiAgICB9XHJcblxyXG4gICAgb25Nb3VzZU1vdmUoZGF0YTogTGF5YS5FdmVudCkge1xyXG4gICAgICAgIHRoaXMub25IYW1tZXJNb3ZlKG5ldyBMYXlhLlBvaW50KGRhdGEuc3RhZ2VYLCBkYXRhLnN0YWdlWSkpO1xyXG4gICAgfVxyXG5cclxuICAgIG9uRGlzYWJsZSgpOiB2b2lkIHtcclxuICAgICAgICBMaXN0ZW5lck1nci5JbnN0YW5jZSgpLm9mZkFsbENhbGxlcih0aGlzKTtcclxuICAgIH1cclxufSIsIlxyXG5cclxuZXhwb3J0IGNsYXNzIExpc3RlbmVyTWdyIGV4dGVuZHMgTGF5YS5FdmVudERpc3BhdGNoZXIge1xyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBMYXlhLkV2ZW50RGlzcGF0Y2hlciA9IG5ldyBMYXlhLkV2ZW50RGlzcGF0Y2hlcigpO1xyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgSW5zdGFuY2UoKTogTGlzdGVuZXJNZ3Ige1xyXG4gICAgICAgIHJldHVybiB0aGlzLmluc3RhbmNlO1xyXG4gICAgfVxyXG4gICBcclxufSIsIlxyXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBHYW1lTW9kZWwge1xyXG5cclxuICAgIHByaXZhdGUgc3RhdGljIGluc3RhbmNlOiBHYW1lTW9kZWw7XHJcblxyXG4gICAgY29uc3RydWN0b3IoKSB7XHJcblxyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzdGF0aWMgSW5zdGFjbmUoKSB7XHJcbiAgICAgICAgaWYgKCFHYW1lTW9kZWwuaW5zdGFuY2UpIHtcclxuICAgICAgICAgICAgR2FtZU1vZGVsLmluc3RhbmNlID0gbmV3IEdhbWVNb2RlbCgpO1xyXG4gICAgICAgIH1cclxuICAgICAgICByZXR1cm4gR2FtZU1vZGVsLmluc3RhbmNlO1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2N1ck1vdXNlVHlwZTogbnVtYmVyO1xyXG5cclxuICAgIHB1YmxpYyBnZXQgY3VyTW91c2VUeXBlKCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJNb3VzZVR5cGU7XHJcbiAgICB9XHJcblxyXG4gICAgcHVibGljIHNldCBjdXJNb3VzZVR5cGUodHlwZTogbnVtYmVyKSB7XHJcbiAgICAgICAgdGhpcy5fY3VyTW91c2VUeXBlID0gdHlwZTtcclxuICAgIH1cclxuXHJcbiAgICBwcml2YXRlIF9jdXJIb2xlSWR4OiBudW1iZXI7XHJcblxyXG4gICAgcHVibGljIGdldCBjdXJIb2xlSWR4KCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9jdXJIb2xlSWR4O1xyXG4gICAgfVxyXG5cclxuICAgIHB1YmxpYyBzZXQgY3VySG9sZUlkeChpZHgpIHtcclxuICAgICAgICB0aGlzLl9jdXJIb2xlSWR4ID0gaWR4O1xyXG4gICAgfVxyXG5cclxuICAgIHByaXZhdGUgX2hlYXJDb3VudDogbnVtYmVyO1xyXG5cclxuICAgIHB1YmxpYyBnZXRIZWFyQ291bnQoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2hlYXJDb3VudDtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgaGVhckNvdW50TWludXMoKSB7XHJcbiAgICAgICAgdGhpcy5faGVhckNvdW50LS07XHJcbiAgICAgICAgaWYgKHRoaXMuX2hlYXJDb3VudCA8IDApIHtcclxuICAgICAgICAgICAgdGhpcy5faGVhckNvdW50ID0gMDtcclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZ2FtZVNjb3JlOiBudW1iZXI7XHJcblxyXG4gICAgcHVibGljIGdldCBnYW1lU2NvcmUoKSB7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2dhbWVTY29yZTtcclxuICAgIH1cclxuXHJcbiAgICBwdWJsaWMgc2V0IGdhbWVTY29yZShudW06IG51bWJlcikge1xyXG4gICAgICAgIHRoaXMuX2dhbWVTY29yZSA9IG51bTtcclxuICAgIH1cclxuICAgIFxyXG5cclxufSJdfQ==
